---
title: 特征提取——
date: 2018-07-16 09:39:40
tags: [GitHub, Mysql]
---

特征提取

<!--more-->
### HOG特征
https://blog.csdn.net/coming_is_winter/article/details/72850511
https://blog.csdn.net/zouxy09/article/details/7929348/
```
总结：Dalal提出的Hog特征提取的过程：把样本图像分割为若干个像素的单元（cell），把梯度方向平均划分为9个区间（bin），在每个单元里面对所有像素的梯度方向在各个方向区间进行直方图统计，得到一个9维的特征向量，每相邻的4个单元构成一个块（block），把一个块内的特征向量联起来得到36维的特征向量，用块对样本图像进行扫描，扫描步长为一个单元。最后将所有块的特征串联起来，就得到了人体的特征。

例如，对于64*128的图像而言，每16*16的像素组成一个cell，每2*2个cell组成一个块，因为每个cell有9个特征，所以每个块内有4*9=36个特征，以8个像素为步长，那么，水平方向将有7个扫描窗口，垂直方向将有15个扫描窗口。也就是说，64*128的图片，总共有36*7*15=3780个特征。

特征总数： 一个cell有9个特征（9个梯度方向），每个特征cell块里有 num*9个特征，步长像素规格：（列像素数-步长）/步长*（行像素数-步长）/步长，
总特征数:（列像素数-步长）/步长*（行像素数-步长）/步长*num*9
```

---

### LOG特征
```
图像与某一个二维函数进行卷积运算实际就是求取图像与这一函数的相似性。同理，图像与高斯拉普拉斯函数的卷积实际就是求取图像与高斯拉普拉斯函数的相似性。当图像中的斑点尺寸与高斯拉普拉斯函数的形状趋近一致时，图像的拉普拉斯响应达到最大。
```
Laplace可以用来检测图像中的局部极值点，但是对噪声敏感，所以在我们对图像进行Laplace卷积之前，我们用一个高斯低通滤波对图像进行卷积，目标是去除图像中的噪声点
```
先对图像f(x,y)用方差为σ的高斯核进行高斯滤波，去除图像中的噪点。

L(x,y;σ)=f(x,y)∗G(x,y;σ)
G(x,y;σ)高斯核
然后对图像的拉普拉斯图像则为：

∇^2=(∂^2L/∂^x2)+(∂^2L/∂y^2)
而实际上有下面等式：

∇^2[G(x,y)∗f(x,y)]=∇^2[G(x,y)]∗f(x,y)

我们可以先求高斯核的拉普拉斯算子，再对图像进行卷积
```


---
### haar特征
Haar特征分为三类：边缘特征、线性特征、中心特征和对角线特征，组合成特征模板。特征模板内有白色和黑色两种矩形，并定义该模板的特征值为<h3>白色矩形像素和减去黑色矩形像素和</h3>

### Haar-like特征

https://blog.csdn.net/zouxy09/article/details/7929570

```
积分图就是只遍历一次图像就可以求出图像中所有区域像素和的快速算法，大大的提高了图像特征值计算的效率。

       积分图主要的思想是将图像从起点开始到各个点所形成的矩形区域像素之和作为一个数组的元素保存在内存中，当要计算某个区域的像素和时可以直接索引数组的元素，不用重新计算这个区域的像素和，从而加快了计算（这有个相应的称呼，叫做动态规划算法）。积分图能够在多种尺度下，使用相同的时间（常数时间）来计算不同的特征，因此大大提高了检测速度。

       我们来看看它是怎么做到的。

       积分图是一种能够描述全局信息的矩阵表示方法。积分图的构造方式是位置（i,j）处的值ii(i,j)是原图像(i,j)左上角方向所有像素的和：
```
归一化图像
```
i¯(x,y)=(i(x,y)−μ)/cσ
公式中i¯(x,y)表示归一化之后的图像，而i(x,y)表示原始的图像，其中μ表示图像的均值，而σ表示图像的标准差
σ2=(1/N)∑x2−μ2   2是平方
```


---
### LBP图像特征

图像处理之特征提取（二）之LBP特征简单梳理</br>
https://blog.csdn.net/coming_is_winter/article/details/72859957</br>
https://blog.csdn.net/zouxy09/article/details/7929531</br>
LBP特征理解。</br>
http://blog.csdn.net/hqh45/article/details/24501097
LBP（Local Binary Pattern，局部二值模式）是一种用来描述图像局部纹理特征的算子；它具有旋转不变性和灰度不变性等显著的优点。它是首先由T. Ojala, M.Pietikäinen, 和 D. Harwood 在1994年提出，用于纹理特征提取。而且，提取的特征是图像的局部的纹理特征；

```
lbp理论：
原始的LBP算子定义为在3*3的窗口内，以窗口中心像素为阈值，将相邻的8个像素的灰度值与其进行比较，若周围像素值大于中心像素值，则该像素点的位置被标记为1，否则为0。这样，3*3邻域内的8个点经比较可产生8位二进制数（通常转换为十进制数即LBP码，共256种），即得到该窗口中心像素点的LBP值，并用这个值来反映该区域的纹理信息。
理论是由LBP图像的
```

```
（1）圆形LBP算子： 半径为R
基本的 LBP算子的最大缺陷在于它只覆盖了一个固定半径范围内的小区域，这显然不能满足不同尺寸和频率纹理的需要。为了适应不同尺度的纹理特征，并达到灰度和旋转不变性的要求，Ojala等对 LBP 算子进行了改进，将 3×3邻域扩展到任意邻域，并用圆形邻域代替了正方形邻域，改进后的 LBP 算子允许在半径为 R 的圆形邻域内有任意多个像素点。从而得到了诸如半径为R的圆形区域内含有P个采样点的LBP算子；
```
即不断旋转圆形邻域得到一系列初始定义的 LBP值，取其最小值作为该邻域的 LBP 值。

---

### SIFT特征
SIFT的全称是Scale Invariant Feature Transform，尺度不变特征变换(物体怎么转，人都能识别)。SIFT特征对旋转、尺度缩放、亮度变化等保持不变性，是一种非常稳定的局部特征。

有4个主要步骤

1、尺度空间的极值检测 搜索所有尺度空间上的图像，通过高斯微分函数来识别潜在的对尺度和选择不变的兴趣点。

2、特征点定位 在每个候选的位置上，通过一个拟合精细模型来确定位置尺度，关键点的选取依据他们的稳定程度。

3、特征方向赋值 基于图像局部的梯度方向，分配给每个关键点位置一个或多个方向，后续的所有操作都是对于关键点的方向、尺度和位置进行变换，从而提供这些特征的不变性。

4、特征点描述 在每个特征点周围的邻域内，在选定的尺度上测量图像的局部梯度，这些梯度被变换成一种表示，这种表示允许比较大的局部形状的变形和光照变换。

### 尺度空间

多分辨率图像金字塔:
```
1、对原始图像进行平滑
2、对处理后的图像进行降采样（通常是水平、垂直方向的1/2）降采样后得到一系列不断尺寸缩小的图像。显然，一个传统的金字塔中，每一层的图像是其上一层图像长、高的各一半。多分辨率的图像金字塔虽然生成简单，但其本质是降采样，图像的局部特征则难以保持，也就是无法保持特征的尺度不变性。
```
高斯尺度空间：
```
图像的模糊程度来模拟人在距离物体由远到近时物体在视网膜上成像过程，距离物体越近其尺寸越大图像也越模糊，这就是高斯尺度空间，使用不同的参数模糊图像（分辨率不变）

图像和高斯函数进行卷积运算，图像模糊，使用不同的“高斯核”可得到不同模糊程度的图像

L(x,y,σ)=G(x,y,σ)∗I(x,y)

其中G(x,y,σ)是高斯核函数
G(x,y,σ)=（1/2Πσ^2）e^((x^2+y^2)/(2σ^2))
```
构建尺度空间的目的是为了检测出在不同的尺度下都存在的特征点，而检测特征点较好的算子是Δ^2G(高斯拉普拉斯,LoG）

















---

边缘检测：
https://blog.csdn.net/tigerda/article/details/61192943

常见边缘检测算子：Roberts 、Sobel 、Prewitt、Laplacian、Log/Marr、Canny、Kirsch、Nevitia</br>

一阶微分算子：Roberts 、Sobel 、Prewitt</br>
```
模板：
Roberts  
|1, 0|
|0,-1|

sobel算子
|1, 0 , 1|
|1, 0 , 1|
|1, 0 , 1|

prewitt算子
|1, 0 , 1|
|1, 0 , 1|
|1, 0 , 1|

Sobel各向同性算子:

   |-1  ,0,  1|     |-1,-跟2,-1|
Gx=|-跟2,0,跟2| ,Gx=| 0,   0, 0|
   |-1  ,0,  1|     | 1, 跟2, 1|

Sobel各向同性算子的权值比普通Sobel算子的权值更准确。为什么？模板的权值是离中心位置越远则权值（看绝对值）影响越小
```
计算边缘幅值与方向？以Sobel算子为例。3*3Sobel两个方向的算子在图像上滑动，模板与其覆盖的图像3*3区域9个像素进行卷积，求和后得到此方向的边缘检测幅值。
```
   |-1,0,1|            |-1,-2,-1|
Gx=|-2,0,2|*f(x,y) ,Gx=| 0, 0, 0|*f(x,y)
   |-1,0,1|            | 1, 2, 1|

G^2=Gx^2+Gy^2

P=arctan(Gx/Gy)

f(x,y)为图像，Gx和Gy分别是水平和竖直方向算子的卷积结果，G则是最终得到的边缘幅值，θ值则是边缘方向。当然G的计算有时简化为
G=|Gx|+|Gy| 或者 G=max(|Gx|,|Gy|)

```

二阶微分算子：Laplacian、Log/Marr
```
Laplacian算子
   |-1,-1,-1|      
Gx=|-1, 8,-1|
   |-1,-1,-1|

   | 0,-1, 0|      
Gx=|-1, 4,-1|
   | 0,-1, 0|

   |-2,-4,-4,-4,-2|
   |-4, 0, 8, 0,-4|      
Gx=|-4, 8,24, 8,-4|
   |-4, 0, 8, 0,-4|
   |-2,-4,-4,-4,-2|
Log边缘检测则是先进行高斯滤波再进行拉普拉斯算子检测
```

非微分边缘检测算子：Canny

|算 子 |优缺点比较|
|----|----|
|Roberts| 对具有陡峭的低噪声的图像处理效果较好，但利用 Roberts算子提取边缘的结果是边缘比较粗，因此边缘定位不是很准确。
|Sobel| 对灰度渐变和噪声较多的图像处理效果比较好， Sobel算子对边缘定位比较准确。
|Kirsch |对灰度渐变和噪声较多的图像处理效果较好。
|Prewitt |对灰度渐变和噪声较多的图像处理效果较好。
|aplacian| 对图像中的阶跃性边缘点定位准确，对噪声非常敏感，丢失一部分边缘的方向信息，造成一些不连续的检测边缘。
|LoG |算 子 经 常 出 现 双 边 缘 像 素 边 界 ， 而 且 该 检 测 方 法 对 噪 声 比铰 敏 感 ， 所 以 很 少 用 LoG算 子 检 测 边 缘 ， 而 是 用 来 判 断 边 缘 像素是位于图像的明区还是暗区。
|Canny |此方法不容易受噪声的干扰，能够检测到真正的弱边缘。在edge函数中，最有效的边缘检测方法是 Canny方法。该方法的优点在于使用两种不同的阈值分别检测强边缘和弱边缘，并且汉当弱边缘与强边缘相连时，才将弱边缘包含在输出图像中。因此，这种方法不容易被噪声“填充”，跟容易检测出真正的弱边缘。
---